{
  "swagger": "2.0",
  "info": {
    "description": "",
    "version": "1.0.0",
    "title": "MDCLight",
    "contact": {
      "email": "info@codestryke.com"
    }
  },
  "host": "localhost:5000",
  "basePath": "/v1",
  "tags": [
    {
      "name": "datasource",
      "description": "Everything about the data source"
    }
  ],
  "schemes": ["https", "http"],
  "paths": {
    "/datasources": {
      "get": {
        "description": "Returns all available datasources of the runtime",
        "parameters": [],
        "produces": ["application/json"],
        "responses": {
          "200": {
            "description": "",
            "schema":{
              "$ref": "#/definitions/dataSourceList"
            }
          }
        }
      }
    },
    "/datasources/{id}": {
      "patch": {
        "summary": "enable or disable datasource",
        "description": "Only for toggling enabled property",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "id of the datasource to patch",
            "required": true,
            "type": "string"
          },
          {
            "name": "enabled",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/enableDatasource"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully enable/disable datasource",
            "schema": {
              "$ref": "#/definitions/dataSourceType"
            }
          }
        }
      },
      "get": {
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "id of the datasource to patch",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Request dateSource with given ID",
            "schema":{
              "$ref": "#/definitions/dataSourceType"
            }
          }
        }
      }
    },
    "/datasinks": {
      "get": {
        "description": "Returns all available datesinks of the runtime",
        "parameters": [],
        "produces": ["application/json"],
        "responses": {
          "200": {
            "description": "Successful request to datasinks",
            "schema": {
              "type": "object",
              "properties": {
                "datasinks": {
                  "type": "array",
                  "items": {
                    "$ref": "#/definitions/dataSinkType"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/datasinks/{id}": {
      "get": {
        "summary": "Get datasink object by id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Datasink object",
            "schema":{
              "$ref": "#/definitions/dataSinkType"
            }
          }
        }
      }
    },
    "/dataPoints": {
      "get": {
        "responses": {
          "200":{
            "description": "Return list of dataPoints",
            "schema": {
              "$ref": "#/definitions/dataPointList"
            }
          }
        }
      },
      "post": {
        "parameters": [
          {
            "name": "dataPoint",
            "in": "body",
            "description": "New Datapoint object",
            "schema": {
              "$ref": "#/definitions/dataPointType"
            }
          }
        ],
        "responses": {
          "200":{
            "description": "Response of a new created dataPoint",
            "schema":{
              "$ref": ""
              }
          }
        }
      }
    },
    "/dataPoints/{id}": {
      "get": {
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "id of the datapoint to get",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "$ref": ""
          }
        }
      },
      "patch": {
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "id of the datasource to patch",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "Response of a change request for a datapoint with given id",
            "schema": {
              "$ref": ""
            }
          }
        }
      }
    }
  },
  "definitions": {
    "enableDatasource": {
      "description": "JSON type for change enable state",
      "type": "object",
      "required": ["enabled"],
      "properties": {
        "enabled": {
          "type": "boolean"
        }
      }
    },
    "virtualdatapoint": {
      "type": "object",
      "required": ["id", "sources", "operationType"],
      "properties": {
        "id": {
          "type": "string"
        },
        "sources": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string"
          }
        },
        "operationType": {
          "type": "string",
          "pattern": "[and|or|not|counter]"
        }
      }
    },

    "sourcedatapoint": {
      "type": "object",
      "required": ["id", "name", "address", "readFrequency"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "address": {
          "type": "string",
          "pattern": "TODO:"
        },
        "readFrequency": {
          "type": "integer",
          "minimum": 0
        },
        "description": {
          "type": "string"
        }
      }
    },
    "dataSinkType": {
      "type": "object",
      "properties": {
        "id":{
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "datapoints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataSinkdatapoint"
          }
        },
        "enabled": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "dataSinkdatapoint": {
      "type": "object",
      "required": ["id", "name"],
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "map": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "initValue": {
          "type": "integer",
          "description": "Value is index for the map data items."
        }
      }
    },
    "datasinkArrayItem": {
      "required": ["name", "id", "href"],
      "properties": {
        "name": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "protocol":{
          "type": "string"
        },
        "href": {
          "type": "string"
        }
      }
    },
    "virtualdatapointArrayItem": {
      "required": ["name", "id", "href"],
      "properties": {
        "name": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "href": {
          "type": "string"
        }
      }
    },
    "dataSourceType": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "dataPoints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/sourcedatapoint"
          }
        },
        "protocol": {
          "type": "string"
        },
        "connection": {
          "$ref": "#/definitions/connection"
        },
        "enabled": {
          "type": "boolean"
        }
      }
    },
    "dataSourceList": {
      "type": "object",
      "properties": {
        "dataSources": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataSourceType"
          }
        }
      }
    },
    "datasourceArrayItem": {
      "required": ["name", "id", "href", "enabled"],
      "properties": {
        "name": {
          "type": "string"
        },
        "id": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "href": {
          "type": "string"
        }
      }
    },
    "connection": {
      "type": "object",
      "properties": {
        "ipAddr": {
          "type": "string"
        },
        "port":{
          "type": "integer",
          "minimum": 0
        },
        "rack":{
          "type": "number",
          "minimum": 0
        },
        "slot": {
          "type": "number",
          "minimum": 0
        }
      }
    },
    
    "dataPointList": {
      "type": "object",
      "properties": {
        "dataPoints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataPointType"
          }
        }
      }
    },
    "dataPointType":{
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name":{
          "type": "string"
        },
        "type":{
          "type": "string",
          "enum": ["event"]
        },
        "map":{
          "type": "array",
          "items": {
            "type": "string"
          }

        },
        "initValue":{
          "description": "index af map for the init value",
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "dataPointArrayItem": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": ["event"]
        }
      }
    }
  }
}
